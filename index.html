<!DOCTYPE html>
<html>
<head>
    <title>Coffee Machine</title>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

    <script type="text/javascript">
      document.onclick = function() {
          $.ajax({
              url: "brew/1",
              dataType: "json",
              async: false
          })
          location.reload()
      }
      document.oncontextmenu = function() {
          $.ajax({
              url: "brew/2",
              dataType: "json",
              async: false
          })
          location.reload()
      }
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var jsonData = $.ajax({
          url: "last",
          dataType:"json",
          async: false
          }).responseText;
        $('#printHere').html(eval(jsonData));

        var jsonData = $.ajax({
          url: "favourites",
          dataType:"json",
          async: false
          }).responseText;
        var newData = eval(JSON.parse(jsonData));
        var data = google.visualization.arrayToDataTable(newData);
        var options = {
          title: 'Brew Favourites'
        };
        var chart = new google.visualization.PieChart(document.getElementById('piechart'));
        chart.draw(data, options);

        var options = {
          title: 'Coffee by Brew Time',
          hAxis: {title: 'Time' },
          vAxis: {title: 'Count'}
        };
        var jsonData = $.ajax({
          url: "scatter",
          dataType:"json",
          async: false
          }).responseText;
        var newData = eval(JSON.parse(jsonData));
        var data = google.visualization.arrayToDataTable(newData);
        var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));
        chart.draw(data, options);

        var jsonData = $.ajax({
          url: "dow",
          dataType:"json",
          async: false
          }).responseText;
        var newData = eval(JSON.parse(jsonData));
        var data = google.visualization.arrayToDataTable(newData);
        var options = {
          title: 'Average by Day of Week',
          legend: {position:'none'}
        };
        var chart = new google.visualization.BarChart(document.getElementById('average'));
        chart.draw(data, options);
      }
    </script>
</head>
<body>
<a href="https://github.com/ryazwinski/coffee"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png" alt="Fork me on GitHub"></a>
<center>
<H1>Coffee Machine Stats</H1>
<P>Instructions: Use the mouse buttons to log a brew of house or sumatra.</P>

<P>Last brew <span id="printHere"></span></P>
<span id="piechart" style="width: 45%; height: 350px;float: left;"></span>
<span id="chart_div" style="width: 45%; height: 350px;float: right;"></span>
<br>
<span id="average" style="width: 45%; height: 350px;float: left;"></span>
</center>
<span style="padding-top: 300px; float: right; font-size: 8pt">Fork me at: http://github.com/ryazwinski/coffee</span>
</body>
</html>
