<!DOCTYPE html>
<html>
<head>
    <title>Coffee Machine</title>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var jsonData = $.ajax({
          url: "last",
          dataType:"json",
          async: false
          }).responseText;
        $('#printHere').html(eval(jsonData));

        var jsonData = $.ajax({
          url: "favourites",
          dataType:"json",
          async: false
          }).responseText;

        var newData = eval(JSON.parse(jsonData));

        var data = google.visualization.arrayToDataTable(newData);

        var options = {
          title: 'Brew Favourites'
        };

        var chart = new google.visualization.PieChart(document.getElementById('piechart'));
        chart.draw(data, options);

        var options = {
          title: 'Coffee by Brew Time',
          hAxis: {title: 'Time', minValue: 0, maxValue: 1440, ticks: [0, 60, 120, 180, 240, 300, 360, 420, 480,
                    540, 600, 660, 720, 780, 840, 900, 960, 1020, 1080, 1140, 1200, 1260, 1320, 1380, 1440] },
          vAxis: {title: 'Count'},
          legend: 'none'
        };
        var jsonData = $.ajax({
          url: "scatter",
          dataType:"json",
          async: false
          }).responseText;

        var newData = eval(JSON.parse(jsonData));

        var data = google.visualization.arrayToDataTable(newData);
        var chart = new google.visualization.ScatterChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
</head>
<body>
<H1>Coffee Machine Stats</H1>

<P>Last brew <span id="printHere"></span></P>
<span id="piechart" style="width: 45%; height: 500px;float: left;"></span>
<span id="chart_div" style="width: 45%; height: 500px;float: right;"></span>

</body>
</html>
